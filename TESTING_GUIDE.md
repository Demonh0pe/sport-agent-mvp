# ğŸ§ª æµ‹è¯•æŒ‡å— - å¦‚ä½•éªŒè¯ç³»ç»ŸåŠŸèƒ½

**æ›´æ–°æ—¥æœŸ**: 2025-11-25

---

## ğŸ“‹ ç›®å½•

1. [å¿«é€ŸéªŒè¯æ•°æ®æ¸…ç†](#1-å¿«é€ŸéªŒè¯æ•°æ®æ¸…ç†)
2. [æµ‹è¯•AgentåŠŸèƒ½](#2-æµ‹è¯•agentåŠŸèƒ½)
3. [æµ‹è¯•é¢„æµ‹æ¨¡å‹](#3-æµ‹è¯•é¢„æµ‹æ¨¡å‹)
4. [æµ‹è¯•æ•°æ®ç®¡é“](#4-æµ‹è¯•æ•°æ®ç®¡é“)
5. [å®Œæ•´æµ‹è¯•æµç¨‹](#5-å®Œæ•´æµ‹è¯•æµç¨‹)

---

## 1ï¸âƒ£ å¿«é€ŸéªŒè¯æ•°æ®æ¸…ç†

### æ–¹æ³•1: è¿è¡ŒéªŒè¯è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /Users/dylan/Desktop/sport\ agent\ mvp
source .venv/bin/activate
python scripts/quick_verify_data.py
```

**æœŸæœ›è¾“å‡º**:
```
================================================================================
ğŸ” æ•°æ®çœŸå®æ€§éªŒè¯
================================================================================

1ï¸âƒ£ æ£€æŸ¥è™šå‡Seedæ•°æ®...
   âœ… æ²¡æœ‰è™šå‡Seedæ•°æ®ï¼Œæ•°æ®åº“å·²æ¸…æ´

2ï¸âƒ£ æ£€æŸ¥2025-11-21çš„æ›¼è”vsåˆ©ç‰©æµ¦æ¯”èµ›...
   âœ… 11æœˆ21æ—¥æ²¡æœ‰æ›¼è”vsåˆ©ç‰©æµ¦çš„æ¯”èµ›ï¼ˆæ­£ç¡®ï¼ï¼‰

3ï¸âƒ£ æ›¼è”æœ€è¿‘5åœºçœŸå®æ¯”èµ›:
   2025-11-24: MUN vs EVE (0-1) | âœ… API
   2025-11-08: TOT vs MUN (2-2) | âœ… API
   2025-11-01: NOT vs MUN (2-2) | âœ… API
   2025-10-25: MUN vs BHA (4-2) | âœ… API
   2025-10-19: LIV vs MUN (1-2) | âœ… API

4ï¸âƒ£ æ•°æ®æ¥æºç»Ÿè®¡:
   - æ¥è‡ªAPIçš„çœŸå®æ•°æ®: 500 åœº
   - å…¶ä»–æ¥æº: 0 åœº
   âœ… æ‰€æœ‰æ•°æ®å‡æ¥è‡ªå®˜æ–¹API

================================================================================
âœ…âœ…âœ… æ•°æ®éªŒè¯é€šè¿‡ï¼æ‰€æœ‰æ•°æ®å‡çœŸå®å¯é  âœ…âœ…âœ…
================================================================================
```

### æ–¹æ³•2: æ‰‹åŠ¨æŸ¥è¯¢æ•°æ®åº“

```bash
python -c "
from src.agent.tools.match_tool import match_tool
import asyncio

async def test():
    # æµ‹è¯•æ›¼è”æ•°æ®
    result = await match_tool.get_recent_matches('æ›¼è”', limit=5)
    print(result)

asyncio.run(test())
"
```

**æœŸæœ›è¾“å‡º**:
```
ğŸ“Š æ›¼è” (MUN) è¿‘ 5 åœºæ¯”èµ›è®°å½•ï¼š
- æ—¥æœŸ: 2025-11-24 | å¯¹é˜µ: MUN vs EVE | æ¯”åˆ†: 0 : 1 (è´Ÿ)
- æ—¥æœŸ: 2025-11-08 | å¯¹é˜µ: TOT vs MUN | æ¯”åˆ†: 2 : 2 (å¹³)
- æ—¥æœŸ: 2025-11-01 | å¯¹é˜µ: NOT vs MUN | æ¯”åˆ†: 2 : 2 (å¹³)
- æ—¥æœŸ: 2025-10-25 | å¯¹é˜µ: MUN vs BHA | æ¯”åˆ†: 4 : 2 (èƒœ)
- æ—¥æœŸ: 2025-10-19 | å¯¹é˜µ: LIV vs MUN | æ¯”åˆ†: 1 : 2 (èƒœ)
```

âœ… **å…³é”®éªŒè¯ç‚¹**:
- ä¸åº”è¯¥å‡ºç°2025-11-21çš„æ¯”èµ›
- æ‰€æœ‰æ¯”èµ›éƒ½åº”è¯¥æœ‰çœŸå®çš„æ—¥æœŸå’Œæ¯”åˆ†

---

## 2ï¸âƒ£ æµ‹è¯•AgentåŠŸèƒ½

### å®Œæ•´Agentæµ‹è¯•ï¼ˆåŒ…å«é¢„æµ‹åŠŸèƒ½ï¼‰

```bash
python scripts/test_agent_with_prediction.py
```

**æµ‹è¯•æ¡ˆä¾‹**:
1. âœ… "æ›¼è”å¯¹åˆ©ç‰©æµ¦ï¼Œè°ä¼šèµ¢ï¼Ÿ" - æµ‹è¯•é¢„æµ‹åŠŸèƒ½
2. âœ… "é¢„æµ‹ä¸€ä¸‹æ‹œä»å’Œå¤šç‰¹çš„æ¯”èµ›" - æµ‹è¯•å¾·ç”²æ•°æ®ï¼ˆå¦‚æœæœ‰ï¼‰
3. âœ… "çš‡é©¬vså·´è¨ï¼Œå“ªä¸ªé˜Ÿä¼šè·èƒœ" - æµ‹è¯•è¥¿ç”²æ•°æ®
4. âœ… "åˆ©ç‰©æµ¦åœ¨è‹±è¶…ä¸­å¤„äºä»€ä¹ˆåœ°ä½" - æµ‹è¯•æ’åæŸ¥è¯¢
5. âœ… "æ›¼è”æœ€è¿‘5åœºæ¯”èµ›çš„æˆ˜ç»©å¦‚ä½•" - æµ‹è¯•å†å²æ•°æ®

**æœŸæœ›ç»“æœ**:
- æ‰€æœ‰æŸ¥è¯¢éƒ½åº”è¯¥åŸºäºçœŸå®æ•°æ®
- ä¸åº”è¯¥å‡ºç°"2025-11-21æ›¼è”0-3åˆ©ç‰©æµ¦"çš„è™šå‡ä¿¡æ¯
- Agentå›ç­”åº”è¯¥æœ‰æ•°æ®æ”¯æ’‘

### å•ç‹¬æµ‹è¯•æŸä¸ªæŸ¥è¯¢

```bash
python -c "
from src.services.api.services.agent_v2 import agent_service
import asyncio

async def test():
    response = await agent_service.process_query('æ›¼è”æœ€è¿‘5åœºæ¯”èµ›çš„æˆ˜ç»©å¦‚ä½•')
    print('Agentå›ç­”:')
    print(response.answer)
    print()
    print('å·¥å…·è°ƒç”¨:')
    for step in response.execution_steps:
        print(f'- {step.tool_name}: {step.execution_time_ms}ms')

asyncio.run(test())
"
```

---

## 3ï¸âƒ£ æµ‹è¯•é¢„æµ‹æ¨¡å‹

### å¿«é€Ÿæµ‹è¯•é¢„æµ‹åŠŸèƒ½

```bash
python scripts/quick_test_prediction.py
```

æˆ–è€…æ‰‹åŠ¨æµ‹è¯•:

```bash
python -c "
from src.agent.tools.prediction_tool import prediction_tool
import asyncio

async def test():
    # æµ‹è¯•æ›¼è”vsåˆ©ç‰©æµ¦çš„é¢„æµ‹
    result = await prediction_tool.predict('Manchester United', 'Liverpool')
    print(result)

asyncio.run(test())
"
```

**æœŸæœ›è¾“å‡º**:
```
ã€æ¯”èµ›é¢„æµ‹ã€‘Manchester United vs Liverpool

é¢„æµ‹ç»“æœ: Liverpool å®¢åœºè·èƒœ
ç½®ä¿¡åº¦: 86.9%

è¯¦ç»†æ¦‚ç‡:
- Manchester United è·èƒœ: 10.4%
- å¹³å±€: 2.7%
- Liverpool è·èƒœ: 86.9%
```

---

## 4ï¸âƒ£ æµ‹è¯•æ•°æ®ç®¡é“

### æµ‹è¯•æ•°æ®æ‘„å–ï¼ˆä»APIæ‹‰å–æ–°æ•°æ®ï¼‰

```bash
python src/data_pipeline/ingest_football_data_v2.py
```

**æœŸæœ›è¡Œä¸º**:
- ä»football-data.org APIæ‹‰å–æœ€æ–°æ¯”èµ›æ•°æ®
- è‡ªåŠ¨åˆ›å»ºä¸å­˜åœ¨çš„çƒé˜Ÿ
- æ‰€æœ‰æ–°å¢æ•°æ®éƒ½å¸¦æœ‰ `['ImportedFromAPI', 'PL']` æ ‡ç­¾
- ä¸åº”è¯¥åˆ›å»ºä»»ä½•è™šå‡æ•°æ®

### éªŒè¯æ•°æ®è´¨é‡

```bash
python scripts/check_data_quality.py
```

**æ£€æŸ¥é¡¹**:
- âœ… æ¯”åˆ†åˆç†æ€§ï¼ˆ0-20ä¹‹é—´ï¼‰
- âœ… æ—¥æœŸä¸€è‡´æ€§ï¼ˆFINISHEDçŠ¶æ€çš„æ¯”èµ›æ—¥æœŸåº”è¯¥åœ¨è¿‡å»ï¼‰
- âœ… æ•°æ®æ¥æºæ ‡ç­¾ï¼ˆå¿…é¡»æœ‰ImportedFromAPIï¼‰
- âœ… æ— é‡å¤æ¯”èµ›

---

## 5ï¸âƒ£ å®Œæ•´æµ‹è¯•æµç¨‹

### Step 1: éªŒè¯æ•°æ®æ¸…ç†

```bash
# 1. éªŒè¯è™šå‡æ•°æ®å·²åˆ é™¤
python scripts/quick_verify_data.py

# æœŸæœ›: âœ… æ²¡æœ‰è™šå‡Seedæ•°æ®
```

### Step 2: æµ‹è¯•åŸºç¡€åŠŸèƒ½

```bash
# 2. æµ‹è¯•match_tool
python -c "
from src.agent.tools.match_tool import match_tool
import asyncio
asyncio.run(match_tool.get_recent_matches('æ›¼è”', 5))
" | grep "2025-11-21"

# æœŸæœ›: æ²¡æœ‰è¾“å‡ºï¼ˆå› ä¸º11-21æ²¡æœ‰æ¯”èµ›ï¼‰
```

### Step 3: æµ‹è¯•Agentå®Œæ•´åŠŸèƒ½

```bash
# 3. è¿è¡Œå®Œæ•´Agentæµ‹è¯•
python scripts/test_agent_with_prediction.py

# æœŸæœ›: æ‰€æœ‰5ä¸ªæµ‹è¯•é€šè¿‡ï¼Œæ— è™šå‡æ•°æ®
```

### Step 4: éªŒè¯é¢„æµ‹åŠŸèƒ½

```bash
# 4. æµ‹è¯•é¢„æµ‹å·¥å…·
python scripts/quick_test_prediction.py

# æœŸæœ›: è¿”å›åˆç†çš„é¢„æµ‹æ¦‚ç‡
```

---

## ğŸ¯ å…³é”®éªŒè¯ç‚¹

### âœ… æ•°æ®çœŸå®æ€§

æµ‹è¯•å‘½ä»¤:
```bash
python scripts/quick_verify_data.py
```

æ£€æŸ¥:
- [ ] æ²¡æœ‰è™šå‡Seedæ•°æ®ï¼ˆ`2024_EPL_MUN_LIV`, `2024_EPL_ARS_MCI`ï¼‰
- [ ] 11æœˆ21æ—¥æ²¡æœ‰æ›¼è”vsåˆ©ç‰©æµ¦çš„æ¯”èµ›
- [ ] æ‰€æœ‰æ•°æ®éƒ½å¸¦æœ‰ `ImportedFromAPI` æ ‡ç­¾

### âœ… AgentåŠŸèƒ½

æµ‹è¯•å‘½ä»¤:
```bash
python scripts/test_agent_with_prediction.py
```

æ£€æŸ¥:
- [ ] "æ›¼è”å¯¹åˆ©ç‰©æµ¦" - ä¸å¼•ç”¨è™šå‡çš„11-21æ¯”èµ›
- [ ] "æ›¼è”æœ€è¿‘5åœº" - è¿”å›çœŸå®çš„5åœºæ¯”èµ›
- [ ] é¢„æµ‹åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] å›ç­”æœ‰æ•°æ®æ”¯æ’‘

### âœ… é¢„æµ‹å‡†ç¡®æ€§

æµ‹è¯•å‘½ä»¤:
```bash
python scripts/quick_test_prediction.py
```

æ£€æŸ¥:
- [ ] æ¦‚ç‡æ€»å’Œä¸º100%
- [ ] ç½®ä¿¡åº¦åˆç†ï¼ˆ20%-90%ï¼‰
- [ ] é¢„æµ‹ç»“æœç¬¦åˆå¸¸è¯†

---

## ğŸš¨ å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1: ä»ç„¶çœ‹åˆ°è™šå‡æ•°æ®

**ç—‡çŠ¶**: 
```
- 2025-11-21: æ›¼è” vs åˆ©ç‰©æµ¦ (0:3)
```

**è§£å†³**:
```bash
# é‡æ–°è¿è¡Œæ¸…ç†è„šæœ¬
python scripts/cleanup_fake_data.py

# éªŒè¯
python scripts/quick_verify_data.py
```

### é—®é¢˜2: Agentè¿”å›ç©ºæ•°æ®

**ç—‡çŠ¶**:
```
æ•°æ®åº“ä¸­æš‚æ—  æ›¼è” çš„è¿‘æœŸæ¯”èµ›è®°å½•ã€‚
```

**åŸå› **: å¯èƒ½è¿‡æ»¤æ‰äº†æ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬çœŸå®æ•°æ®ï¼‰

**è§£å†³**:
```bash
# æ£€æŸ¥æ•°æ®æ ‡ç­¾
python -c "
from src.infra.db.session import AsyncSessionLocal
from src.infra.db.models import Match
from sqlalchemy import select
import asyncio

async def check():
    async with AsyncSessionLocal() as db:
        stmt = select(Match).limit(5)
        result = await db.execute(stmt)
        for m in result.scalars():
            print(f'{m.match_id}: tags={m.tags}')

asyncio.run(check())
"

# åº”è¯¥çœ‹åˆ°: tags=['ImportedFromAPI', 'PL']
```

### é—®é¢˜3: æ•°æ®åº“è¿æ¥å¤±è´¥

**ç—‡çŠ¶**:
```
PermissionError: [Errno 1] Operation not permitted
```

**è§£å†³**:
```bash
# 1. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å¯åŠ¨
docker-compose ps

# 2. æ£€æŸ¥é…ç½®
cat config/db.yaml

# 3. é‡å¯æ•°æ®åº“
docker-compose restart postgres
```

---

## ğŸ“Š æµ‹è¯•æ¸…å•

### æ•°æ®éªŒè¯ âœ…

- [ ] è¿è¡Œ `python scripts/quick_verify_data.py`
- [ ] ç¡®è®¤æ²¡æœ‰è™šå‡Seedæ•°æ®
- [ ] ç¡®è®¤11-21æ²¡æœ‰æ›¼è”vsåˆ©ç‰©æµ¦
- [ ] ç¡®è®¤æ‰€æœ‰æ•°æ®æœ‰APIæ ‡ç­¾

### Agentæµ‹è¯• âœ…

- [ ] è¿è¡Œ `python scripts/test_agent_with_prediction.py`
- [ ] æµ‹è¯•1é€šè¿‡ï¼ˆæ›¼è”vsåˆ©ç‰©æµ¦é¢„æµ‹ï¼‰
- [ ] æµ‹è¯•5é€šè¿‡ï¼ˆæ›¼è”æˆ˜ç»©æŸ¥è¯¢ï¼‰
- [ ] æ‰€æœ‰å›ç­”åŸºäºçœŸå®æ•°æ®

### é¢„æµ‹æµ‹è¯• âœ…

- [ ] è¿è¡Œ `python scripts/quick_test_prediction.py`
- [ ] é¢„æµ‹æ¦‚ç‡åˆç†
- [ ] ç½®ä¿¡åº¦æ­£å¸¸

### æ•°æ®ç®¡é“ âœ…

- [ ] å¯ä»¥ä»APIæ‹‰å–æ–°æ•°æ®
- [ ] æ–°æ•°æ®å¸¦æœ‰æ­£ç¡®æ ‡ç­¾
- [ ] æ²¡æœ‰åˆ›å»ºè™šå‡æ•°æ®

---

## ğŸ”„ æŒç»­æµ‹è¯•å»ºè®®

### æ¯æ—¥æµ‹è¯•

```bash
# ç®€å•éªŒè¯è„šæœ¬
python scripts/quick_verify_data.py
```

### æ¯å‘¨æµ‹è¯•

```bash
# å®Œæ•´æµ‹è¯•å¥—ä»¶
python scripts/test_agent_with_prediction.py
python scripts/check_data_quality.py
```

### æ•°æ®æ›´æ–°å

```bash
# 1. æ‹‰å–æ–°æ•°æ®
python src/data_pipeline/ingest_football_data_v2.py

# 2. éªŒè¯æ•°æ®è´¨é‡
python scripts/check_data_quality.py

# 3. æµ‹è¯•Agent
python scripts/test_agent_with_prediction.py
```

---

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

è¿è¡Œæµ‹è¯•åï¼Œè®°å½•ç»“æœ:

```
æµ‹è¯•æ—¥æœŸ: 2025-11-25
æµ‹è¯•äººå‘˜: [ä½ çš„åå­—]

âœ… æ•°æ®éªŒè¯:
   - è™šå‡æ•°æ®: 0æ¡
   - APIæ•°æ®: 500æ¡
   - æ•°æ®è´¨é‡: é€šè¿‡

âœ… Agentæµ‹è¯•:
   - 5/5 æµ‹è¯•é€šè¿‡
   - æ— è™šå‡æ•°æ®å¼•ç”¨
   - å›ç­”å‡†ç¡®æ€§: è‰¯å¥½

âœ… é¢„æµ‹æµ‹è¯•:
   - é¢„æµ‹åŠŸèƒ½: æ­£å¸¸
   - æ¦‚ç‡åˆ†å¸ƒ: åˆç†
   - ç½®ä¿¡åº¦: æ­£å¸¸

âœ… é—®é¢˜:
   - æ— 

ç»“è®º: âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
```

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- [æ•°æ®çœŸå®æ€§ä¿®å¤æŠ¥å‘Š](./docs/æ•°æ®çœŸå®æ€§ä¿®å¤æŠ¥å‘Š.md)
- [æ•°æ®å®¡æŸ¥æŠ¥å‘Š](./docs/DATA_AUTHENTICITY_AUDIT.md)
- [ä¿®å¤æªæ–½è¯´æ˜](./docs/DATA_FIX_SUMMARY.md)

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼** å¦‚æœ‰é—®é¢˜è¯·æŸ¥çœ‹ä¸Šè¿°æ’æŸ¥æŒ‡å—ã€‚ ğŸš€

